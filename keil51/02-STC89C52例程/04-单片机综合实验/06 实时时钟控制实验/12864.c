#define uchar unsigned char
#define uint  unsigned int


sbit LCD_E = P2^4;			//定义管脚
sbit LCD_RW = P2^3;
sbit LCD_RS = P2^2;
sbit LCD_CS2 = P2^1;
sbit LCD_CS1 = P2^0;
#define  Data_Port P0
uint tt[]={0,0,0};
uchar code mm[]={1,2,3,10,4,5,6,11,7,8,9,12,14,0,15,13};
uchar code Dot[][32] =        // 数据表
{

//-0- 年 --
      {0x00,0x20,0x10,0xCC,0x47,0x44,0x44,0xFC,0x44,0x44,0x44,0x64,0x46,0x04,0x00,0x00,
      0x84,0x84,0x84,0x87,0x84,0x84,0x84,0xFF,0x84,0x84,0x84,0x84,0x84,0x86,0x84,0x80},
//-1- 月 --
      {0x00,0x00,0x00,0x00,0xFE,0x22,0x22,0x22,0x22,0x22,0x22,0xFF,0x02,0x00,0x00,0x00,
      0x80,0x80,0xC0,0xB0,0x8F,0x82,0x82,0x82,0x82,0xC2,0x82,0xFF,0x80,0x80,0x80,0x80},
//-2- 日 --
      {0x00,0x00,0x00,0xFE,0x82,0x82,0x82,0x82,0x82,0x82,0x82,0xFF,0x02,0x00,0x00,0x00,
      0x80,0x80,0x80,0xFF,0xA0,0xA0,0xA0,0xA0,0xA0,0xA0,0xA0,0xFF,0x80,0x80,0x80,0x80},
//-3- 实 --
      {0x10,0x0C,0x04,0x44,0x8C,0x94,0x35,0x06,0xF4,0x04,0x04,0x04,0x04,0x14,0x0C,0x00,
      0x82,0x82,0x82,0xC2,0xC2,0xA3,0x92,0x8E,0x83,0x8A,0x92,0xA2,0xC2,0xC3,0x82,0x80},
//-4- 时 --
      {0x00,0xFC,0x84,0x84,0x84,0xFE,0x14,0x10,0x90,0x10,0x10,0x10,0xFF,0x10,0x10,0x00,
      0x80,0xBF,0x90,0x90,0x90,0xBF,0x80,0x80,0x80,0xA3,0xC0,0x80,0xFF,0x80,0x80,0x80},
//-5- 钟 --
      {0x80,0x40,0x70,0xCF,0x48,0x48,0x00,0xF0,0x10,0x10,0xFF,0x10,0x10,0xF8,0x10,0x00,
      0x82,0x82,0x82,0xFF,0xA2,0x92,0x80,0x87,0x82,0x82,0xFF,0x82,0x82,0x87,0x80,0x80},
//-6- 调 --
      {0x20,0x21,0xE6,0x00,0x00,0xFE,0x82,0x92,0x92,0xFE,0x92,0xD2,0x82,0xFF,0x02,0x00,
      0x80,0x80,0xBF,0x90,0xC8,0xBF,0x80,0xBE,0x92,0x92,0x92,0xDE,0x80,0xFF,0x80,0x80},
//-7- 节 --
      {0x04,0x24,0x24,0x24,0x24,0x3F,0xE4,0x24,0x24,0x3F,0x24,0x24,0xF4,0x26,0x04,0x00,
      0x80,0x80,0x80,0x80,0x80,0x80,0xFF,0x80,0x80,0x84,0x88,0x90,0x8F,0x80,0x80,0x80},
//-8- 分 --
      {0x00,0x80,0x40,0x20,0x98,0x86,0x80,0x80,0x83,0x8C,0x90,0x20,0xC0,0x80,0x80,0x00,
      0x81,0x80,0x80,0xC0,0xA0,0x9F,0x80,0xC0,0x80,0xC0,0xBF,0x80,0x80,0x81,0x80,0x80},
//-9- 秒 --
      {0x20,0x24,0x24,0xA4,0xFE,0xA3,0x22,0x80,0x70,0x00,0xFF,0x00,0x10,0x20,0x60,0x00,
      0x90,0x88,0x86,0x81,0xFF,0x80,0x81,0x80,0xC0,0xA0,0x97,0x88,0x84,0x83,0x80,0x80},
//-10- 闹 --
      {0x00,0xF9,0x02,0x26,0x20,0x22,0x2A,0xF2,0x22,0x22,0xB2,0x22,0x02,0xFF,0x02,0x00,
      0x80,0xFF,0x80,0x80,0x9F,0x81,0x81,0xFF,0x81,0x91,0x9F,0xC1,0x80,0xFF,0x80,0x80},
//-11- 铃 --
      {0x80,0x40,0x70,0xCF,0x48,0x48,0x20,0x10,0x2C,0xC3,0x0C,0x10,0x60,0xC0,0x40,0x00,
      0x80,0x82,0x82,0xFF,0xA2,0x92,0x80,0x82,0x92,0xA2,0xD2,0x8A,0x86,0x80,0x80,0x80},
//-12-    --
      {0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
      0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF}

};


uchar code num[][16] =              // ASCII
{
	{0xF8,0xFC,0x04,0xC4,0x24,0xFC,0xF8,0x00,0x87,0x8F,0x89,0x88,0x88,0x8F,0x87,0x80}, // -0-

	{0x00,0x10,0x18,0xFC,0xFC,0x00,0x00,0x00,0x80,0x88,0x88,0x8F,0x8F,0x88,0x88,0x80}, // -1-

	{0x08,0x0C,0x84,0xC4,0x64,0x3C,0x18,0x00,0x8E,0x8F,0x89,0x88,0x88,0x8C,0x8C,0x80}, // -2-

	{0x08,0x0C,0x44,0x44,0x44,0xFC,0xB8,0x00,0x84,0x8C,0x88,0x88,0x88,0x8F,0x87,0x80}, // -3-

	{0xC0,0xE0,0xB0,0x98,0xFC,0xFC,0x80,0x00,0x80,0x80,0x80,0x88,0x8F,0x8F,0x88,0x80}, // -4-

	{0x7C,0x7C,0x44,0x44,0xC4,0xC4,0x84,0x00,0x84,0x8C,0x88,0x88,0x88,0x8F,0x87,0x80}, // -5-

	{0xF0,0xF8,0x4C,0x44,0x44,0xC0,0x80,0x00,0x87,0x8F,0x88,0x88,0x88,0x8F,0x87,0x80}, // -6-

	{0x0C,0x0C,0x04,0x84,0xC4,0x7C,0x3C,0x00,0x80,0x80,0x8F,0x8F,0x80,0x80,0x80,0x80}, // -7-

	{0xB8,0xFC,0x44,0x44,0x44,0xFC,0xB8,0x00,0x87,0x8F,0x88,0x88,0x88,0x8F,0x87,0x80}, // -8-

	{0x38,0x7C,0x44,0x44,0x44,0xFC,0xF8,0x00,0x80,0x88,0x88,0x88,0x8C,0x87,0x83,0x80}, // -9-
	
	{0xE0,0xF0,0x98,0x8C,0x98,0xF0,0xE0,0x00,0x8F,0x8F,0x80,0x80,0x80,0x8F,0x8F,0x80}, // 10-A-

	{0x04,0xFC,0xFC,0x44,0x44,0xFC,0xB8,0x00,0x88,0x8F,0x8F,0x88,0x88,0x8F,0x87,0x80}, // 11-B-

	{0xF0,0xF8,0x0C,0x04,0x04,0x0C,0x18,0x00,0x83,0x87,0x8C,0x88,0x88,0x8C,0x86,0x80}, // 12-C-

	{0x04,0xFC,0xFC,0x04,0x0C,0xF8,0xF0,0x00,0x88,0x8F,0x8F,0x88,0x8C,0x87,0x83,0x80}, // 13-D-

	{0x80,0xA0,0xE0,0xC0,0xC0,0xE0,0xA0,0x80,0x80,0x82,0x83,0x81,0x81,0x83,0x82,0x80}, // 14-*-
	
	{0x20,0xF8,0xF8,0x20,0xF8,0xF8,0x20,0x00,0x82,0x8F,0x8F,0x82,0x8F,0x8F,0x82,0x80}, // 15-#-

	{0x00,0x00,0x00,0x30,0x30,0x00,0x00,0x00,0x80,0x80,0x80,0x86,0x86,0x80,0x80,0x80}, // 16-:-

	{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x80,0x80,0x8C,0x8C,0x80,0x80,0x80},  // 17-.-

	{0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF}  // 18- -
};


void mDelay(uint Delay)	//延时
{
	uint i;
	for(;Delay > 0;Delay--)	 
		for(i = 0;i < 110;i++);
}
/*-------------------------------------------------------
函数名称: Write_Com()
函数功能: 向LCD12864里写命令
参数    : left  左边芯片选通位
right 右边芯片选通位
Com  要写的命令
返回值  : 无
---------------------------------------------------------*/
void Write_Com(uchar com)
{

	LCD_E=0;
	LCD_RS=0;
	LCD_E=1; 
	Data_Port=com;  
}
/*-------------------------------------------------------
函数名称: Write_Data()
函数功能: 向LCD12864里写数据
参数    : left  左边芯片选通位
right 右边芯片选通位
Data  要写的数据
返回值  : 无
---------------------------------------------------------*/
void Write_Data(uchar Data)
{

	LCD_E=0;
	LCD_RS=1;
	LCD_E=1;
	Data_Port=Data;  
}
/*-----------------------------------------
函数名称: LCD12864_Disp()
函数功能: 在任意位置上显示汉字
参数    : X X地址位置 
Y Y地址位置 
*P 指针 数据的首地址
返回值  : 无
------------------------------------------*/
void LCD12864_Disp(uchar x, uchar y, uchar *p )
{
	uchar i,j;
	char k;

	for(i=0;i<32;i++)
	{
		if(i>=16)
		{
			j=1;
			k=-16;
		}
		else j=0,k=0;
		Write_Com(0xb8+j+x);     //设置X地址
		Write_Com(0x40+i+y+k);   //设置Y地址
		Write_Data(p[i]);        //送数据
	}

}
/*-----------------------------------------
函数名称: LCD12864_DispNum()
函数功能: 在任意位置上显示数字
参数    : X X地址位置 
Y Y地址位置 
*P 指针 数据的首地址
返回值  : 无
------------------------------------------*/
void LCD12864_DispNum(uchar x, uchar y, uchar *p )
{
	uchar i,j;
	char k;
	for(i=0;i<16;i++)
	{    
		if(i>=8)
		{
		j=1;
		k=-8;
		}
		else j=0,k=0;
		Write_Com(0xb8+x+j); //设置X地址
		Write_Com(0x40+i+y+k);//设置Y地址
		Write_Data(p[i]);//送数据
	}
}
/*-------------------------------------------------------
函数名称: LCD12864_Init()
函数功能: LCD12864初始化
参数    : 
返回值  : 无
---------------------------------------------------------*/
void LCD12864_Init()
{
	Data_Port=0xFF;
	LCD_CS1=0;
	LCD_CS2=0;
	LCD_E=1;
	LCD_RW=0;
	Write_Com(0x3e);//显示关
	Write_Com(0x3f);//显示开
	Write_Com(0xc0);//显示起始行
	Write_Com(0xb8);//设置X地址
	Write_Com(0x40);//设置Y地址	、
	

}
/*---------------------------------------------------
函数名称: LCD12864_Clear()
函数功能: 清屏
参数    : left  清左屏
right 清右屏
返回值  ：无
【说明】 : 0 0  不清屏  11  清全屏
0 1  清右屏  10  清左屏
-----------------------------------------------------*/
void LCD12864_Clear()
{
	uchar aa,bb;//aa控制X地址 bb控制Y地址

		for(aa=0;aa<8;aa++)
		{
			Write_Com(0xb8+aa);
			LCD_CS1=0;
			LCD_CS2=1;
			for(bb=0;bb<64;bb++)
			{
				Write_Data(0x00);
			}
			LCD_CS1=1;
			LCD_CS2=0;
			for(bb=0;bb<64;bb++)
			{

				Write_Data(0x00);
			} 
		}
 
}
 void Display()
{
	LCD_CS1=0;
	LCD_CS2=1;
	LCD12864_Disp(0,16,Dot[3]);                
	LCD12864_Disp(0,40,Dot[4]);                
	LCD12864_DispNum(3,16,num[2]);
	LCD12864_DispNum(3,24,num[0]);
	LCD12864_Disp(3,48,Dot[0]);                               
	LCD12864_DispNum(6,56,num[16]);
	LCD_CS1=1;
	LCD_CS2=0;	                
	LCD12864_Disp(0,8,Dot[4]);                  
	LCD12864_Disp(0,32,Dot[5]);
	LCD12864_Disp(3,16,Dot[1]);
	LCD12864_Disp(3,48,Dot[2]);
	LCD12864_DispNum(6,16,num[16]);


}
void display(uchar *dis,uchar *dis1)
{

	LCD_CS1=0;
	LCD_CS2=1;	                
	LCD12864_DispNum(3,32,num[dis[2]]);
	LCD12864_DispNum(3,40,num[dis[3]]);
	LCD12864_DispNum(6,40,num[dis1[0]]);
	LCD12864_DispNum(6,48,num[dis1[1]]);
	LCD_CS1=1;
	LCD_CS2=0;
	LCD12864_DispNum(3,0,num[dis[5]]);
	LCD12864_DispNum(3,8,num[dis[6]]);
	LCD12864_DispNum(3,32,num[dis[8]]);
	LCD12864_DispNum(3,40,num[dis[9]]);
	LCD12864_DispNum(6,0,num[dis1[3]]);	                
	LCD12864_DispNum(6,8,num[dis1[4]]);
	LCD12864_DispNum(6,24,num[dis1[6]]);
	LCD12864_DispNum(6,32,num[dis1[7]]);

}

void display1(uchar *dis)
{

	LCD_CS1=0;
	LCD_CS2=1;	                
	LCD12864_DispNum(3,32,num[dis[2]]);
	LCD12864_DispNum(3,40,num[dis[3]]);
	LCD_CS1=1;
	LCD_CS2=0;
	LCD12864_DispNum(3,0,num[dis[5]]);
	LCD12864_DispNum(3,8,num[dis[6]]);
	LCD12864_DispNum(3,32,num[dis[8]]);
	LCD12864_DispNum(3,40,num[dis[9]]);	                
	mDelay(500);
}


void display2(uchar *dis)
{

	LCD_CS1=0;
	LCD_CS2=1;	                
	LCD12864_DispNum(6,40,num[dis[0]]);
	LCD12864_DispNum(6,48,num[dis[1]]);
	LCD_CS1=1;
	LCD_CS2=0;
	LCD12864_DispNum(6,0,num[dis[3]]);	                
	LCD12864_DispNum(6,8,num[dis[4]]);
	LCD12864_DispNum(6,24,num[dis[6]]);
	LCD12864_DispNum(6,32,num[dis[7]]);
	mDelay(500);
}

void display3(uchar *dis)
{

	LCD_CS1=0;
	LCD_CS2=1;	                
	LCD12864_DispNum(6,40,num[dis[0]]);
	LCD12864_DispNum(6,48,num[dis[1]]);
	LCD_CS1=1;
	LCD_CS2=0;
	LCD12864_DispNum(6,0,num[dis[2]]);	                
	LCD12864_DispNum(6,8,num[dis[3]]);
	LCD12864_DispNum(6,24,num[dis[4]]);
	LCD12864_DispNum(6,32,num[dis[5]]);
	mDelay(500);
}


