C51 COMPILER V9.54   MAIN                                                                  05/30/2024 17:41:27 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: D:\51project\Keil_v5\keil\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2
                    -)

line level    source

   1          #include <REGX51.H>
   2          #define uchar unsigned char   //ºê¶¨Òå£¬Îª·½±ã±à³Ì
   3          #define uint unsigned int
   4          #define DIGI P0         //ºê¶¨Òå£¬½«P0¿Ú¶¨ÒåÎªÊýÂë¹Ü¶ÎÑ¡½Ó¿Ú
   5          #define SELECT P2         //ºê¶¨Òå£¬½«P2¶¨ÒåÎªÊýÂë¹ÜÑ¡Ôñ¿Ú
   6          uchar mod=0;
   7          uchar chage;
   8          uchar digivalue[]={0x3F,0x06,0x5B,0x4F,0x66,0x6D,0x7D,0x07,0x7f,0x6f,0x80};
   9          //ÏÔÊ¾µÄÊý×ÖÊý×é£¬ÒÀ´ÎÎª0£¬1£¬..£¬7
  10          uchar select[]={0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80}; //Ñ¡ÔñÊýÂë¹ÜÊý×é£¬ÒÀ´ÎÑ¡Ôñ1£¬2£¬..£¬8
  11          
  12          uchar date[]={2,0,2,4,0,5,3,0};
  13          uchar time[8];
  14          uchar haomiao=0,second=0,min=0,t=0;
  15          
  16          void delay() //ÑÓ³Ùº¯Êý£¬¾ö¶¨ÊýÂë¹ÜÌø±äµÄ¼ä¸ôÊ±¼ä
  17          { 
  18   1        uchar ii=200; //Èô·¢ÏÖÊýÂë¹ÜÉÁË¸£¬µ÷½ÚÕâÀï¼´¿É
  19   1        while(ii--);
  20   1      }
  21          
  22          void Timer0_Init(void)    //1??@12.000MHz
  23          {
  24   1        TMOD &= 0xF0;     //???????
  25   1        TMOD |= 0x01;     //???????
  26   1        TL0 = 0x18;       //???????
  27   1        TH0 = 0xFC;       //???????
  28   1        TF0 = 1;        
  29   1        TR0 = 1;
  30   1      }
  31          
  32          void key_init(){
  33   1        IE=0x85;
  34   1        PX1=1;
  35   1        IT0 = 1;    //Íâ²¿ÖÐ¶Ï0£¬Âö³å´¥·¢·½Ê½£¬ÏÂ½µÑØ´¥·¢ÓÐÐ
  36   1        IT1 = 1;
  37   1      }
  38          
  39          main() //Ö÷º¯Êý
  40          {
  41   1        uchar i=0;
  42   1        Timer0_Init();
  43   1        key_init();
  44   1        EA=1;
  45   1        while(1)
  46   1        { 
  47   2          if(mod==1){
  48   3            for(i=0;i<8;i++)    //8¸öÊýÂë¹ÜÂÖÁ÷ÏÔÊ¾
  49   3            {
  50   4              SELECT=select[i];   //Ñ¡ÔñµÚi¸öÊýÂë¹Ü
  51   4              DIGI=0x90;
  52   4              DIGI=digivalue[date[i]];  //ÏÔÊ¾i
  53   4              delay(); 
  54   4            }
C51 COMPILER V9.54   MAIN                                                                  05/30/2024 17:41:27 PAGE 2   

  55   3          }
  56   2          else{
  57   3            ET0=1;
  58   3            time[0]=min/10;time[1]=min%10;time[2]=10;
  59   3            time[3]=second/10;time[4]=second%10;time[5]=10;
  60   3            time[6]=haomiao/10;time[7]=haomiao%10;
  61   3            for(i=0;i<8;i++)    //8¸öÊýÂë¹ÜÂÖÁ÷ÏÔÊ¾
  62   3            {
  63   4              SELECT=select[i];   //Ñ¡ÔñµÚi¸öÊýÂë¹Ü
  64   4              DIGI=0x90;
  65   4              DIGI=digivalue[time[i]];  //ÏÔÊ¾i
  66   4              delay(); 
  67   4            }
  68   3          }
  69   2        }
  70   1      }
  71          
  72          void clock() interrupt 1
  73          {
  74   1        t++;
  75   1        if(t>=10){
  76   2        haomiao++;
  77   2        if(haomiao==100){ haomiao=0;second++;}
  78   2        if(second==60){second=0;min++;}
  79   2        if(min==60){min=0;second=0;}
  80   2        t=0;
  81   2        }
  82   1        TL0 = 0x18;       //???????
  83   1        TH0 = 0xFC;       //???????
  84   1      }
  85          
  86          void INIT_0(void) interrupt 0
  87          {
  88   1        uchar i=0;
  89   1        while(1){
  90   2          SELECT=select[0];   //Ñ¡ÔñµÚi¸öÊýÂë¹Ü
  91   2          DIGI=0x90;
  92   2          DIGI=digivalue[mod];  //ÏÔÊ¾i
  93   2          delay(); 
  94   2          if(P3_4==0){
  95   3            delay();
  96   3            if(P3_4==0){
  97   4              while(P3_4==0);
  98   4              break;
  99   4            }
 100   3          }
 101   2          if(P3_5==0){
 102   3            delay();
 103   3            if(P3_5==0){
 104   4              mod=(mod+1)%2;
 105   4              while(P3_5==0);
 106   4            }
 107   3          }
 108   2        }
 109   1      }
 110          
 111          void INIT_1(void) interrupt 2
 112          {
 113   1        uchar i=0;
 114   1        while(1){
 115   2          time[0]=min/10;time[1]=min%10;time[2]=10;
 116   2          time[3]=second/10;time[4]=second%10;time[5]=10;
C51 COMPILER V9.54   MAIN                                                                  05/30/2024 17:41:27 PAGE 3   

 117   2          time[6]=haomiao/10;time[7]=haomiao%10;
 118   2          for(i=0;i<8;i++)    //8¸öÊýÂë¹ÜÂÖÁ÷ÏÔÊ¾
 119   2          {
 120   3              SELECT=select[i];   //Ñ¡ÔñµÚi¸öÊýÂë¹Ü
 121   3              DIGI=0x90;
 122   3              DIGI=digivalue[time[i]];  //ÏÔÊ¾i
 123   3              delay(); 
 124   3          }
 125   2          if(P3_6==0){
 126   3            delay();
 127   3            if(P3_6==0){
 128   4              while(P3_6==0);
 129   4              break;
 130   4            }
 131   3          }
 132   2          if(P3_7==0){
 133   3            delay();
 134   3            if(P3_7==0){
 135   4              chage=(chage+1)%3;
 136   4              SELECT=select[0];   //Ñ¡ÔñµÚi¸öÊýÂë¹Ü
 137   4              DIGI=0x90;
 138   4              DIGI=digivalue[chage];  //ÏÔÊ¾i
 139   4              delay(); 
 140   4              while(P3_7==0);
 141   4            }
 142   3          }
 143   2          if(P3_0==0){
 144   3            delay();
 145   3            if(P3_0==0){
 146   4              switch(chage){
 147   5                case 0: haomiao++;break;
 148   5                case 1: second++;break;
 149   5                case 2: min++;break;
 150   5              }
 151   4              while(P3_0==0);
 152   4            }
 153   3          }
 154   2          if(P3_1==0){
 155   3            delay();
 156   3            if(P3_1==0){
 157   4              switch(chage){
 158   5                case 0: haomiao--;break;
 159   5                case 1: second--;break;
 160   5                case 2: min--;break;
 161   5              }
 162   4              while(P3_1==0);
 163   4            }
 164   3          }   
 165   2        }
 166   1      }
 167          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    561    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     41       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.

C51 COMPILER V9.54   MAIN                                                                  05/30/2024 17:41:27 PAGE 4   


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
